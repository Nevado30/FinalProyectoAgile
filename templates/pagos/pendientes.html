{% extends 'base.html' %}
{% block title %}Pagos pendientes{% endblock %}
{% block header %}
  <h1>Pagos pendientes</h1>
  <a class="btn" href="{% url 'pagos:vencidos' %}">Ver vencidos</a>
  <a class="btn" href="{% url 'pagos:lista' %}">Ver todos</a>
{% endblock %}
{% block content %}
  <div class="card">
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>Persona</th>
            <th>Banco</th>
            <th>Cuota</th>
            <th>Vence</th>
            <th>Monto</th>
            <th>Acción</th>
          </tr>
        </thead>
        <tbody>
        {% for p, monto_pen in pagos_ctx %}
          <tr>
            <td>{{ p.prestamo.persona.apellidos }}, {{ p.prestamo.persona.nombres }}</td>
            <td>{{ p.prestamo.banco }}</td>
            <td>{{ p.numero_cuota }}</td>
            <td>{{ p.fecha_vencimiento }}</td>
            <td>{{ p.monto }}</td>
            <td>
              <form method="post" action="{% url 'pagos:marcar_pagado' p.id_pago %}">
                {% csrf_token %}
                <input type="hidden" name="next" value="{{ request.get_full_path }}">
                <input type="hidden" name="base" value="{{ base }}">
                <input type="hidden" name="destino" value="{{ destino }}">
                <button class="btn btn-success" type="submit">Marcar pagado ✓</button>
              </form>
            </td>
          </tr>
        {% empty %}
          <tr><td colspan="6">No tienes pagos pendientes.</td></tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
{% endblock %}
